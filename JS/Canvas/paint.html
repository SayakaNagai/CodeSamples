<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Paint</title>
    <script>
      var mouseDown = false;
      
      var penX = 0;
      var penY = 0;
      var penColor = "rgba(0,0,0,1)";
      var penWidth = 10;

      //描画の開始
      function startDraw(event){
      mouseDown = true;
      penX = event.clientX; //マウスカーソル上の座標
      penY = event.clientY;
      }

      //描画
      function draw(event){
      if(mouseDown){
      var canvas = document.getElementById("main");
      var context = canvas.getContext("2d");

      //ペンのセット
      context.strokeStyle = penColor;
      context.lineWidth = penWidth;
      context.lineCap = "round";
      
      //マウスカーソルの座標を取得
      x = event.clientX;
      y = event.clientY;

      context.beginPath();
      context.moveTo(penX,penY); //startDrawの座標から
      context.lineTo(x,y); //現在の座標
      context.stroke();

      penX = x;
      penY = y;
      }
      }

      //描画の終了
      function endDraw(event){
      mouseDown = false;
      }

      //色の変更
      function changeColor(){
      //スライダーの値を取得
      var penR = document.getElementById("penR").value;
      var penG = document.getElementById("penG").value;
      var penB = document.getElementById("penB").value;
      var penA = document.getElementById("penA").value;
      //ペンの色をセット
      penColor = "rgba("+penR+","+penG+","+penB","+penA+")";
      //ペンの色用のキャンバスの取得
      var canvasColor = document.getElementById("canvasColor");
      var contextColor = canvasColor.getContext("2d");
      
      //ペンの色を塗りつぶしの四角形で表示
      contextColor.clearRect(0,0,20,20); //ペン用のキャンバスを全てクリア
      contectColor.fillStyle = penColor; //penColorで塗りつぶし
      contextColor.fillRect(0,0,20,20);
      //ペンの色をテキストで表示
      var textColor = document.getElementById("textColor"); //spanタグ要素を取り出す
      textColor.innerHTML = "R: "+penR+", G: "+penG+",B: "+penB+", A: "+penA;
      }

    </script>
    <style>
      canvas {
      border : solid #999999 1px;
      }

      .pallet {
      background-color:#EEEEEE;
      border:solid #999999 1px;
      width: 620px;
      paddomg: 10px
      font-size:small;
      }

      #canvasColor {
      background-image: url("pen_back.jpg");
      }
    </style>
  </head>
  <body onLoad="changeColor()">
    <canvas id="main" width="640" height="480" onMouseDown="startDraw(event)" onMouseMove="draw(event)" onMouseUp="endDraw(event)">
    </canvas> 
    <div class="pallet">
      <canvas id="canvasColor" width="20" height="20"></canvas>
      ペンの色：[<span id="textColor">R:0,G:0,B:0,A:1.0</span>]
      R:<input type="range" id="penR" value="0" min="0" max="255" onChange="changeColor()">
      G:<input type="range" id="penG" value="0" min="0" max="255" onChange="changeColor()">
      B:<input type="range" id="penB" value="0" min="0" max="255" onChange="changeColor()">
      A:<input type="range" id="penA" value="1" min="0" max="1" step="0.1" onChange="changeColor()">
    </div>
  </body>
</html>

<!-- 
onMouseDown:マウスボタンが押された時
onMouseMove=マウスが移動した時
onMouseUp=マウスボタンが離された時
-->
